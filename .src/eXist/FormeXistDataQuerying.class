' Gambas class file

' query name inbox
Public query_name As String
' request canceled inbox
Public request_canceled As Boolean
' path inbox
Public path As String

Public Sub ToolButtonNewxPathQuery_Click()
  ' create a new tab in the tabview and add the xPath querying interface
  Dim ui As FormXMLSplit
  Dim ask As FormAskQueryWithPathName
  askagain:
  ask = New FormAskQueryWithPathName
  ask.caller = Me
  request_canceled = False
  ask.ShowModal()
  If Not request_canceled Then
    If Not FMain.main_treeview.Exist(query_name) Then
      FMain.main_tabstrip.Count += 1
      FMain.main_tabstrip.Index = FMain.main_tabstrip.Count - 1
      FMain.main_tabstrip.Text = query_name & " - xPath query"
      ui = New FormXMLSplit(FMain.main_tabstrip)
      ui.query_type = "xpath"
      ui.path = path
    Else
      Message.Error("Such a query name already exists! Please choose a different name.")
      Goto askagain
    Endif
  Endif
End

Public Sub ToolButtonNewxQuery_Click()
  ' create a new tab in the tabview and add the xQuery querying interface
  Dim ui As FormXMLSplit
  Dim ask As FormAskQueryName
  askagain:
  ask = New FormAskQueryName
  ask.caller = Me
  request_canceled = False
  ask.ShowModal()
  If Not request_canceled Then
    If Not FMain.main_treeview.Exist(query_name) Then
      FMain.main_tabstrip.Count += 1
      FMain.main_tabstrip.Index = FMain.main_tabstrip.Count - 1
      FMain.main_tabstrip.Text = query_name & " - xQuery"
      ui = New FormXMLSplit(FMain.main_tabstrip)
      ui.query_type = "xquery"
      ui.path = path
    Else
      Message.Error("Such a query name already exists! Please choose a different name.")
      Goto askagain
    Endif
  Endif
End
